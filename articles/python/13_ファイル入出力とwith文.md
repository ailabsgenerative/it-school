---
title: Pythonのファイル入出力とwith文入門
date: 2025-11-07
categories: [Python]
tags: [AI, Gemini, 自動生成, Python, ファイル入出力とwith文]
---

```markdown
# Pythonのファイル操作をマスターしよう！基本の入出力と安全なwith文の使い方

## 1. はじめに

プログラミングをしていると、「プログラムの実行結果を保存したい」「設定ファイルを読み込みたい」「大量のデータを処理したい」といった様々な場面でファイルを扱いたくなります。このように、プログラムがファイルからデータを読み込んだり、ファイルにデータを書き出したりすることを**ファイル入出力(I/O)**と呼びます。

Pythonでは、このファイル入出力が非常に簡単に行えるように設計されています。そして、ファイルを安全かつ確実に扱うために推奨されているのが`with`文です。この記事では、Pythonにおける基本的なファイルの読み書きの方法と、なぜ`with`文を使うべきなのかを、初心者にも分かりやすく解説します。

## 2. ファイル入出力の基本と`with`文

Pythonでファイルを操作するには、まず`open()`関数を使って対象のファイルを開く必要があります。そして、操作が終わったら必ず`close()`メソッドでファイルを閉じるのがお作法です。しかし、手動で`close()`を管理していると、予期せぬエラーが発生した際にファイルが閉じられず、データが破損するなどの問題が起こる可能性があります。

そこで登場するのが`with`文です。`with`文のブロック内でファイル操作を行うと、処理が正常に終わった場合でも、途中でエラーが発生した場合でも、**ブロックを抜ける際に自動的にファイルを閉じてくれます**。これにより、より安全で簡潔なコードを書くことができます。

### ファイルへの書き込み (`'w'`)

まずは、ファイルにテキストを書き込んでみましょう。`open()`関数の第2引数に`'w'`（書き込みモード）を指定します。

**注意:** `'w'`モードは、ファイルが既に存在する場合、中身をすべて上書きします。新しいファイルを作成するか、中身が消えても良い場合に使用してください。

```python
# 'my_file.txt'という名前のファイルを書き込みモードで開く
with open('my_file.txt', 'w', encoding='utf-8') as f:
    f.write('こんにちは、Python！\n')
    f.write('これは新しいファイルです。\n')

# withブロックを抜けると、ファイルは自動的に閉じられる

print("ファイルへの書き込みが完了しました。")
```

このコードを実行すると、同じディレクトリに`my_file.txt`が作成され、指定したテキストが書き込まれます。`encoding='utf-8'`は、日本語などの非ASCII文字を正しく扱うためのおまじないだと考えておくと良いでしょう。

### ファイルからの読み込み (`'r'`)

次に、先ほど作成したファイルの内容を読み込んでみましょう。モードを`'r'`（読み込みモード）にしてファイルを開き、`read()`メソッドで内容を取得します。

```python
# 'my_file.txt'を読み込みモードで開く
try:
    with open('my_file.txt', 'r', encoding='utf-8') as f:
        content = f.read() # ファイルの全内容を一つの文字列として読み込む
        print('--- ファイルの内容 ---')
        print(content)
        print('--------------------')
except FileNotFoundError:
    print('エラー: my_file.txt が見つかりません。')

# withブロックを抜けると、ファイルは自動的に閉じられる
```

`read()`はファイル全体を一度に読み込みますが、他にも一行ずつ読み込む`readline()`や、全ての行をリストとして読み込む`readlines()`といった便利なメソッドもあります。

### ファイルへの追記 (`'a'`)

既存のファイルの中身を消さずに、末尾に新しい内容を付け加えたい場合は`'a'`（追記モード）を使います。

```python
# 'my_file.txt'に追記モードで新しい行を追加する
with open('my_file.txt', 'a', encoding='utf-8') as f:
    f.write('この行を追記します。\n')

print("ファイルへの追記が完了しました。")

# 追記後の内容を確認
with open('my_file.txt', 'r', encoding='utf-8') as f:
    print(f.read())
```

これを実行すると、`my_file.txt`の内容が消えることなく、新しい行が末尾に追加されていることが確認できます。

## 3. まとめ

今回は、Pythonにおけるファイル入出力の基本と、`with`文を使った安全なファイル操作の方法について学びました。

- **ファイル入出力**は、プログラムでデータを永続化するための基本的な機能です。
- ファイル操作には`open()`関数を使います。
- **`with`文**を使うことで、ファイルの`close()`処理が自動化され、コードが安全かつシンプルになります。
- 用途に応じて、書き込み(`'w'`)、読み込み(`'r'`)、追記(`'a'`)のモードを使い分けましょう。

`with`文を使ったファイル操作は、現代のPythonプログラミングにおける標準的な作法です。この書き方に慣れて、安全で効率的なデータ操作を行いましょう！
```
