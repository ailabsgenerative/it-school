# PLAN_RULE.md: 作業計画に関するルール

## 目的

あなたは、ユーザーから与えられたタスクについて、以下のルールに従い、段階的な作業計画を立案し、実行をアシストしてください。これにより、タスクの透明性を高め、効率的かつ高品質な成果物の提供を目指します。

## 作業計画のフェーズ

ユーザーから新しいタスクが与えられた場合、以下の5つのフェーズで作業を進めてください。

### 1. 事前準備フェーズ (Preparation Phase)
*   **目的:** タスクの概要を把握し、計画のための初期設定を行う。
*   **アクション:**
    *   ユーザーが提示する「実行したいタスクの概要」を完全に理解する。
    *   `!mkdir -p ./.gemini/specs` を実行し、`./.gemini/specs` ディレクトリが存在することを確認する。
    *   タスクの概要から適切な `spec` 名を考案し、`./.gemini/specs/<spec-name>` という名前のディレクトリを作成する。
        *   例: 「記事コンポーネントを作成する」というタスクなら `create-article-component`。
    *   このフェーズ以降で利用する全てのファイル（要件ファイル、設計ファイル、実装計画ファイルなど）は、作成した `spec` ディレクトリの中に配置する。
    *   `./.gemini/specs/<spec-name>/GEMINI_PLAN.md` というファイルを作成し、このフェーズの計画を追記する。
        *   **これは重要なルールです。** `GEMINI_PLAN.md` に計画を追記する際には、過去のフェーズの計画を消さないでください。
*   **成果物:**
    *   `./.gemini/specs/<spec-name>` ディレクトリの作成。
    *   `./.gemini/specs/<spec-name>/GEMINI_PLAN.md` ファイルの作成と、事前準備フェーズの計画の追記。
*   **タスクのフォーマット:** `[ ] タスク内容 (YYYY-MM-DD HH:MM)` の形式で記述する。
    *   例: `[ ] !mkdir -p ./.gemini/specs を実行する (2025-11-08 10:00)`

### 2. 要件フェーズ (Requirements Phase)
*   **目的:** タスクが満たすべき要件を明確にする。
*   **アクション:**
    *   ユーザーから伝えられたタスクの概要に基づいて、タスクが満たすべき「要件ファイル」（例: `./.gemini/specs/<spec-name>/REQUIREMENTS.md`）を作成する。
    *   作成した「要件ファイル」をユーザーに提示し、問題がないか尋ねる。
    *   ユーザーが「要件ファイル」を確認し、問題があればフィードバックする。
    *   ユーザーが「要件ファイル」を確認し、問題がないと答えるまで、「要件ファイル」に対して修正を繰り返す。
*   **成果物:** ユーザーによって承認された「要件ファイル」。

### 3. 設計フェーズ (Design Phase)
*   **目的:** 要件を満たすための設計を策定する。
*   **アクション:**
    *   「要件ファイル」に記載されている要件を満たすような設計を記述した「設計ファイル」（例: `./.gemini/specs/<spec-name>/DESIGN.md`）を作成する。
    *   作成した「設計ファイル」をユーザーに提示し、問題がないか尋ねる。
    *   ユーザーが「設計ファイル」を確認し、問題があればフィードバックする。
    *   ユーザーが「設計ファイル」を確認し、問題がないと答えるまで、「設計ファイル」に対して修正を繰り返す。
*   **成果物:** ユーザーによって承認された「設計ファイル」。

### 4. 実装計画フェーズ (Implementation Plan Phase)
*   **目的:** 設計に基づき、実装のための具体的な計画を策定する。
*   **アクション:**
    *   「設計ファイル」に記載されている設計を実装するための「実装計画ファイル」（例: `./.gemini/specs/<spec-name>/IMPLEMENTATION_PLAN.md`）を作成する。
    *   「実装計画ファイル」はチェックリスト形式で出力する。
    *   作成した「実装計画ファイル」をユーザーに提示し、問題がないか尋ねる。
    *   ユーザーが「実装計画ファイル」を確認し、問題があればフィードバックする。
    *   ユーザーが「実装計画ファイル」を確認し、問題がないと答えるまで、「実装計画ファイル」に対して修正を繰り返す。
*   **成果物:** ユーザーによって承認された「実装計画ファイル」（チェックリスト形式）。

### 5. 実装フェーズ (Implementation Phase)
*   **目的:** 承認された実装計画に基づき、コードを実装する。
*   **アクション:**
    *   「実装計画ファイル」に基づいて実装を開始する。
    *   実装するときは、「要件ファイル」「設計ファイル」に記載されている内容を遵守する。
    *   **タスクが特定の作業（例: 記事本文の生成）を含む場合、関連するルールファイル（例: `./gemini/gemini-rules/02_ARTICLE_GENERATION_RULE.md`）を参照し、そのルールに従って作業を進めること。**
    *   `git commit`を適切なタイミングで行い、作業の進捗を記録する。
    *   実装が完了した際に、チェックリストにチェックをつける。
    *   実装後には、品質確保のためのステップ（リンティング、テスト、ビルドなど）を実行し、結果をユーザーに報告する。
*   **成果物:** タスクの目的を達成した実装済みコード。

---

**ユーザーへの指示:**

Geminiに新しいタスクの計画立案を依頼する際は、以下の形式でプロンプトを提供してください。

```
以下のタスクについて、作業計画を立案してください。

タスクの目的: [ここにタスクの目的を記述]
タスクの背景: [ここにタスクの背景を記述]
```
